****************************************************************************************************************
*						Calculadora						Grupo: 7
*	Este programa es mas fachero que Pele
****************************************************************************************************************
	p68h11		;declara el modelo de microprocesador utilizado.
	extern	initdis,outchar,keypad,init,display,cargon,cargoop,secuizq,calculo
$const.def

	rseg	CODE
	lds 	#st_ini
	jsr	init
mlop	ldy	#I_STR
	jsr	keypad
	
	bcc	lcarga
	ldaa	0,y
	cmpa	#$43		; Se apretó reset?
	bne	noC
	jsr 	init
	jmp	lcarga
	
noC	ldaa	0,y
	cmpa	#$52		; Se apretó "="?
	bne	noR
	jsr 	calculo
	jmp	lcarga

noR	ldaa	0,y
	cmpa	#$30
	blo	noN
	ldx	#mdis
	pshx
	ldx	#op1bcd
	jsr	cargon
	jmp	lcarga

noN 	ldaa	0,y
	beq	lcarga
	ldx	#op1bcd
	ldy	#mdis
	jsr	cargoop
	
	ldx	#mdis
	jsr 	display	
lcarga	bra	mlop 

****************************************************************************************************************
	rseg	VARS
	
op1bcd	rmb	4
op2bcd	rmb	4
op1	rmb	2
oper	rmb	1
op2	rmb	2

mdis	rmb	4
****************************************************************************************************************	

****************************************************************************************************************
  rseg	STACK			STACK
stack	rmb	$50	;el programa hace uso mínimo del stack, pero se asigno un espacio extra.
st_ini	equ	*-1
****************************************************************************************************************

********************  String  ***************************
	rseg	VARS
I_STR	fcc	'0123456789+-C*/R' 
	
	END
