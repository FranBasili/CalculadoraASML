	p68h11
	public	initdis,outchar,init,secuizq
$const.def
	rseg	CODE
**************************************
*Initdis: Inicializar el display
**************************************
initdis equ *
	psha
	ldaa	#$0F 	;set for output
	staa	DDRC 	;C output
	ldaa 	PIOC 	;get current value
	anda 	#$FE 	;reset bit 0 to 0
	staa 	PIOC 	;send it out
	pula
	rts

**************************************
*Outchar: 
* ACCA: Carácter a enviar
* ACCB: Posición (0-3)
**************************************
outchar equ *
	stab	PORTCL 	;set the position
	staa 	PORTB	;set the character
	rts

**************************************
*Init: Inicializa display y resetea memorias
**************************************
init equ *
	jsr	initdis
	clc	op1
	clc	op2
	clc	oper
	clc	caract
	clc	mdis0
	clc	mdis1	
	clc	mdis2
	clc	mdis3
	clc	nop1
	clc	nop2
* BORRAR MEMORIAS BCD	
	
	rts
	
**************************************************************************
*DISPLAY
*  Carga el contenido de las posiciones de memoria mdis0, mdis1, mdis2, mdis3
* y muesta su contenido en el display en la posicion 0, 1, 2, 3, respectivamente
*	Parametros recibidos: Caracateres por memoria
*	Parametros entregados: Ninguno
**************************************************************************

display	equ	*
	
	psha	; Hago backup de los registros
	pshb
	
	ldaa	mdis0	; Cargo el caracter que se ubica en la posicion 0
	ldab	#0
	jsr	outchar	; Utilizo outchar para cargar en el display
	
	ldaa	mdis1	; Cargo el caracter que se ubica en la posicion 1
	ldab	#1
	jsr	outchar	; Utilizo outchar para cargar en el display
	
	ldaa	mdis2	; Cargo el caracter que se ubica en la posicion 2
	ldab	#2
	jsr	outchar	; Utilizo outchar para cargar en el display
	
	ldaa	mdis3	; Cargo el caracter que se ubica en la posicion 3
	ldab	#3
	jsr	outchar	; Utilizo outchar para cargar en el display
	
	pulb	; Recupero los registros
	pula
	rts

***************************************************************************
*SECUIZQ:
* Desplaza hacia la izquierda un lugar el contenido de todas las memorias
*que despues se cargan al display y agrega el nuevo caracter
*	Param. Recibe: Caracter a por AccB
*	Param. Entrega: Ninguno
****************************************************************************
secuizq	equ	*
	
	psha		; Guardo AccA en el stack
	ldaa	mdis2	; Desplazo los contenidos de las memorias que se cargan
	staa	mdis3	;en el display un lugar a la izquierda
	ldaa	mdis1
	staa	mdis2
	ldaa	mdis0
	staa	mdis1
	stab	mdis0	;el caracter derecho
	pula		; Recupero Acca
	rts
	
****************************************************************************
****************************************************************************

	END
